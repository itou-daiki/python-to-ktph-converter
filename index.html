<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Python ⇄ 共通テスト用プログラム表記 変換ツール</title>
    
    <!-- External CSS Libraries -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/theme/material-darker.min.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/components.css">
    <link rel="stylesheet" href="assets/css/layout.css">
    <link rel="stylesheet" href="assets/css/modal.css">
    <link rel="stylesheet" href="assets/css/responsive.css">
    
    <!-- External JavaScript Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/python/python.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pyodide@0.24.1/pyodide.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
</head>
<body>
    <!-- Header -->
    <header>
        <h1>Python ⇄ 共通テスト用プログラム表記 変換ツール</h1>
        <p>Pythonと共通テスト用プログラム表記を相互に変換・実行できます</p>
    </header>

    <!-- Main Container -->
    <div class="container">
        <!-- Controls -->
        <div class="controls">
            <div class="direction-selector">
                <label for="conversionDirection">変換方向:</label>
                <select id="conversionDirection">
                    <option value="pythonToCommon">Python → 共通テスト</option>
                    <option value="commonToPython">共通テスト → Python</option>
                </select>
            </div>
            <button class="convert-button" onclick="convert()">変換</button>
            <button class="run-button" onclick="runCode()">実行</button>
            <button onclick="clearAll()">クリア</button>
            <button onclick="loadExample()">サンプル読込</button>
            <button onclick="shareCode()">共有URL生成</button>
        </div>

        <!-- Main Content Grid -->
        <div class="main-content">
            <!-- Top Left: Python/Input Code -->
            <div class="panel top-left">
                <div class="panel-header">
                    <span id="leftPanelLabel">Python</span>
                    <button class="copy-button" onclick="copyToClipboard('pythonCode')">📋</button>
                </div>
                <div id="pythonEditor"></div>
            </div>
            
            <!-- Top Right: Common Test Notation/Output Code -->
            <div class="panel top-right">
                <div class="panel-header">
                    <span id="rightPanelLabel">共通テスト用プログラム表記</span>
                    <button class="copy-button" onclick="copyToClipboard('commonTestCode')">📋</button>
                </div>
                <div id="commonTestEditor"></div>
            </div>
            
            <!-- Bottom Left: Flowchart -->
            <div class="panel bottom-left">
                <div class="panel-header">
                    <span>フローチャート</span>
                </div>
                <div id="flowchart"></div>
            </div>
            
            <!-- Bottom Right: Execution Output -->
            <div class="panel bottom-right">
                <div class="panel-header">
                    <span>実行結果</span>
                    <button class="copy-button" onclick="clearOutput()">クリア</button>
                </div>
                <div id="output"></div>
            </div>
        </div>

        <!-- Share Section -->
        <div class="share-section">
            <div class="panel-header">共有URL</div>
            <div class="share-url">
                <input type="text" id="shareUrl" readonly placeholder="共有URLが表示されます">
                <button class="copy-button" onclick="copyShareUrl()">URLをコピー</button>
            </div>
        </div>
    </div>

    <!-- Modals and Overlays -->
    <!-- Input Dialog Overlay -->
    <div class="overlay" id="overlay" onclick="closeInputDialog()"></div>
    
    <!-- Input Dialog -->
    <div class="input-dialog" id="inputDialog">
        <h3>入力</h3>
        <input type="text" id="userInput" placeholder="値を入力してください">
        <div style="margin-top: 10px; text-align: right;">
            <button onclick="submitInput()">OK</button>
            <button onclick="closeInputDialog()">キャンセル</button>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <p>Pyodideを初期化中...</p>
    </div>

    <!-- JavaScript Modules -->
    <script src="assets/js/modules/converter.js"></script>
    <script src="assets/js/modules/executor.js"></script>
    <script src="assets/js/modules/flowchart.js"></script>
    <script src="assets/js/modules/ui.js"></script>
    <script src="assets/js/app.js"></script>
</body>
</html>